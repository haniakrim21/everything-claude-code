<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DevBoard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/css/xterm.min.css">
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    .tab-active { border-bottom: 2px solid #3b82f6; color: #3b82f6; }
    .file-tree-item:hover { background: #1e293b; }
    #editor-container { width: 100%; height: 100%; }
    .xterm { height: 100%; }
    .status-2xx { color: #22c55e; } .status-3xx { color: #eab308; }
    .status-4xx { color: #ef4444; } .status-5xx { color: #ef4444; }
    td[contenteditable]:focus { outline: 2px solid #3b82f6; background: #1e293b; }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #0f172a; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
  </style>
</head>
<body class="h-full bg-slate-950 text-slate-200 flex flex-col overflow-hidden">

  <!-- Top Bar -->
  <header class="flex items-center border-b border-slate-800 bg-slate-900 px-4 shrink-0">
    <span class="text-lg font-bold text-blue-400 mr-8 py-3">DevBoard</span>
    <nav class="flex gap-1">
      <button onclick="switchTab('editor')" id="tab-editor" class="px-4 py-3 text-sm font-medium hover:text-blue-400 tab-active">File Editor</button>
      <button onclick="switchTab('database')" id="tab-database" class="px-4 py-3 text-sm font-medium hover:text-blue-400">Database</button>
      <button onclick="switchTab('api')" id="tab-api" class="px-4 py-3 text-sm font-medium hover:text-blue-400">API Tester</button>
      <button onclick="switchTab('terminal')" id="tab-terminal" class="px-4 py-3 text-sm font-medium hover:text-blue-400">Terminal</button>
    </nav>
    <span id="project-root" class="ml-auto text-xs text-slate-500"></span>
  </header>

  <!-- Tab Panels -->
  <main class="flex-1 overflow-hidden">

    <!-- File Editor Tab -->
    <div id="panel-editor" class="h-full flex">
      <aside class="w-64 border-r border-slate-800 flex flex-col shrink-0 bg-slate-900">
        <div class="p-2">
          <input id="file-search" type="text" placeholder="Search files..."
            class="w-full bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500"
            oninput="searchFiles(this.value)">
        </div>
        <div id="file-tree" class="flex-1 overflow-y-auto text-sm px-1"></div>
      </aside>
      <div class="flex-1 flex flex-col">
        <div class="flex items-center gap-2 px-3 py-1.5 border-b border-slate-800 bg-slate-900 shrink-0">
          <span id="current-file" class="text-xs text-slate-400 flex-1 truncate">No file open</span>
          <button onclick="saveFile()" class="px-3 py-1 bg-blue-600 hover:bg-blue-500 rounded text-xs font-medium">Save</button>
        </div>
        <div id="editor-container" class="flex-1"></div>
      </div>
    </div>

    <!-- Database Tab -->
    <div id="panel-database" class="h-full flex hidden">
      <aside class="w-64 border-r border-slate-800 flex flex-col shrink-0 bg-slate-900">
        <div id="db-connect-form" class="p-3 space-y-2">
          <h3 class="text-sm font-semibold text-slate-300">Connect to PostgreSQL</h3>
          <input id="db-host" placeholder="Host" value="localhost" class="w-full bg-slate-800 border border-slate-700 rounded px-2 py-1 text-sm">
          <input id="db-port" placeholder="Port" value="5432" class="w-full bg-slate-800 border border-slate-700 rounded px-2 py-1 text-sm">
          <input id="db-user" placeholder="User" value="postgres" class="w-full bg-slate-800 border border-slate-700 rounded px-2 py-1 text-sm">
          <input id="db-pass" placeholder="Password" type="password" class="w-full bg-slate-800 border border-slate-700 rounded px-2 py-1 text-sm">
          <input id="db-name" placeholder="Database" class="w-full bg-slate-800 border border-slate-700 rounded px-2 py-1 text-sm">
          <button onclick="connectDB()" class="w-full bg-blue-600 hover:bg-blue-500 rounded py-1.5 text-sm font-medium">Connect</button>
          <p id="db-status" class="text-xs text-slate-500"></p>
        </div>
        <div id="db-tables" class="flex-1 overflow-y-auto text-sm px-1 hidden">
          <h3 class="text-xs font-semibold text-slate-400 px-2 py-1">Tables</h3>
          <div id="db-table-list"></div>
        </div>
      </aside>
      <div class="flex-1 flex flex-col">
        <div class="p-3 border-b border-slate-800 bg-slate-900 shrink-0">
          <div class="flex gap-2">
            <textarea id="sql-input" rows="3" placeholder="SELECT * FROM users LIMIT 10;"
              class="flex-1 bg-slate-800 border border-slate-700 rounded px-3 py-2 text-sm font-mono resize-none focus:outline-none focus:border-blue-500"></textarea>
            <button onclick="runQuery()" class="px-4 bg-green-600 hover:bg-green-500 rounded text-sm font-medium self-end">Run</button>
          </div>
          <p id="query-status" class="text-xs text-slate-500 mt-1"></p>
        </div>
        <div id="db-results" class="flex-1 overflow-auto p-3">
          <p class="text-slate-500 text-sm">Connect to a database and run a query or click a table.</p>
        </div>
        <div id="db-pagination" class="hidden items-center gap-2 px-3 py-2 border-t border-slate-800 bg-slate-900 shrink-0">
          <button onclick="dbPrevPage()" class="px-2 py-1 bg-slate-800 rounded text-xs">Prev</button>
          <span id="db-page-info" class="text-xs text-slate-400"></span>
          <button onclick="dbNextPage()" class="px-2 py-1 bg-slate-800 rounded text-xs">Next</button>
        </div>
      </div>
    </div>

    <!-- API Tester Tab -->
    <div id="panel-api" class="h-full flex flex-col hidden">
      <div class="p-3 border-b border-slate-800 bg-slate-900 shrink-0 space-y-3">
        <div class="flex gap-2">
          <select id="api-method" class="bg-slate-800 border border-slate-700 rounded px-2 py-1.5 text-sm font-medium w-28">
            <option>GET</option><option>POST</option><option>PUT</option><option>PATCH</option><option>DELETE</option>
          </select>
          <input id="api-url" placeholder="https://api.example.com/endpoint" class="flex-1 bg-slate-800 border border-slate-700 rounded px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500">
          <button onclick="sendRequest()" class="px-6 bg-blue-600 hover:bg-blue-500 rounded text-sm font-medium">Send</button>
        </div>
        <div>
          <div class="flex items-center justify-between mb-1">
            <span class="text-xs text-slate-400">Headers</span>
            <button onclick="addHeaderRow()" class="text-xs text-blue-400 hover:text-blue-300">+ Add</button>
          </div>
          <div id="api-headers" class="space-y-1">
            <div class="flex gap-2 header-row">
              <input placeholder="Key" class="header-key flex-1 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-xs">
              <input placeholder="Value" class="header-val flex-1 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-xs">
              <button onclick="this.parentElement.remove()" class="text-slate-500 hover:text-red-400 text-xs px-1">x</button>
            </div>
          </div>
        </div>
        <div id="api-body-section">
          <span class="text-xs text-slate-400">Body (JSON)</span>
          <textarea id="api-body" rows="4" placeholder='{"key": "value"}'
            class="w-full mt-1 bg-slate-800 border border-slate-700 rounded px-3 py-2 text-sm font-mono resize-none focus:outline-none focus:border-blue-500"></textarea>
        </div>
      </div>
      <div id="api-response" class="flex-1 overflow-auto p-3">
        <p class="text-slate-500 text-sm">Send a request to see the response.</p>
      </div>
    </div>

    <!-- Terminal Tab -->
    <div id="panel-terminal" class="h-full flex flex-col hidden">
      <div class="flex items-center border-b border-slate-800 bg-slate-900 shrink-0 px-2">
        <div id="term-tabs" class="flex gap-1 py-1"></div>
        <button onclick="createTerminal()" class="ml-2 px-2 py-0.5 text-xs bg-slate-800 hover:bg-slate-700 rounded">+ New</button>
      </div>
      <div id="terminal-panels" class="flex-1 overflow-hidden bg-black"></div>
    </div>

  </main>

  <!-- Monaco Editor Loader -->
  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.50.0/min/vs/loader.min.js"></script>
  <!-- xterm.js -->
  <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
